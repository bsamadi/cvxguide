

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Applications in Control Theory &#8212; Convex Optimization: A Practical Guide</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/mystnb.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .secondtoggle, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"sign": "\\mathop{\\rm sgn}\nolimits", "CO": "{\\textbf{\\rm conv}}", "RR": "{{\\mathcal R}}", "RE": "{\\mathbb{R}}", "TR": "{\\text{T}}", "beq": "\\begin{equation}", "eeq": "\\end{equation}", "bmat": "\\begin{bmatrix}", "emat": "\\end{bmatrix}", "bsmat": "\\left[\\begin{smallmatrix}", "esmat": "\\end{smallmatrix}\\right]", "barr": "\\begin{array}", "earr": "\\end{array}", "bsm": "\\begin{smallmatrix}", "esm": "\\end{smallmatrix}"}}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="References" href="References.html" />
    <link rel="prev" title="Semidefinite program" href="SemidefiniteProgram.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Convex Optimization: A Practical Guide</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
  <li class="">
    <a href="Introduction.html">Introduction</a>
  </li>
  <li class="">
    <a href="ConvexSets.html">Convex Sets</a>
  </li>
  <li class="">
    <a href="ConvexFunctions.html">Convex Functions</a>
  </li>
  <li class="">
    <a href="ConvexOptimization.html">Convex Optimization</a>
  </li>
  <li class="active">
    <a href="">Applications in Control Theory</a>
  </li>
  <li class="">
    <a href="References.html">References</a>
  </li>
</ul>
</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse" data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu" aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation" title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i class="fas fa-download"></i></button>

            
            <div class="dropdown-buttons">
                <!-- ipynb file if we had a myst markdown file -->
                
                <!-- Download raw file -->
                <a class="dropdown-buttons" href="_sources/ApplicationsControlTheory.md.txt"><button type="button" class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip" data-placement="left">.md</button></a>
                <!-- Download PDF via print -->
                <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF" onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
            </div>
            
        </div>

        <!-- Edit this page -->
        

        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->
        
    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#stability" class="nav-link">Stability</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#linear-systems" class="nav-link">Linear Systems</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#uncertain-linear-systems" class="nav-link">Uncertain Linear Systems</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#state-feedback-controller" class="nav-link">State Feedback Controller</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#dissipativity" class="nav-link">Dissipativity</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#qsr-dissipativity" class="nav-link">QSR Dissipativity</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#passivity" class="nav-link">Passivity</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#mathcal-h-infty-gain-bounded-l-2-rightarrow-bounded-l-2" class="nav-link">\mathcal{H}_\infty Gain (Bounded L_2\rightarrow Bounded L_2)</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#mathcal-h-infty-state-feedback-controller" class="nav-link">\mathcal{H}_\infty State Feedback Controller</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#generalized-mathcal-h-2-gain-bounded-l-2-rightarrow-bounded-l-infty" class="nav-link">Generalized \mathcal{H}_2 Gain (Bounded L_2\rightarrow Bounded L_\infty)</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#generalized-mathcal-h-2-state-feedback-controller" class="nav-link">Generalized \mathcal{H}_2 State Feedback Controller</a>
        </li>
    
            </ul>
        </li>
    
    </ul>
</nav>


    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="applications-in-control-theory">
<h1>Applications in Control Theory<a class="headerlink" href="#applications-in-control-theory" title="Permalink to this headline">¶</a></h1>
<p>Many problems in control theory can be formulated as convex optimization
problems. It is beyond the scope of this text to cover all of them. However, in
the following, you will see an introduction about applications of convex
optimization in control theory.</p>
<div class="section" id="stability">
<h2>Stability<a class="headerlink" href="#stability" title="Permalink to this headline">¶</a></h2>
<p>Consider the following autonomous system:</p>
<p>\begin{equation}
\dot x = f(x),\ x(0)=x_0
\end{equation}</p>
<p>with <span class="math notranslate nohighlight">\(x\in\mathbb{R}^n\)</span> and <span class="math notranslate nohighlight">\(t\geq 0\)</span>. A solution of this system with initial
condition <span class="math notranslate nohighlight">\(x(0)=x_0\)</span> is denoted by <span class="math notranslate nohighlight">\(\phi(t,x_0)\)</span>.</p>
<p><span class="math notranslate nohighlight">\(x^\star\)</span> is an equilibrium point of this system if:</p>
<p>\begin{equation}
\forall t \geq 0, \phi(t,x^\star)=x^\star
\end{equation}</p>
<p><em>Definition [2]:</em> An equilibrium point <span class="math notranslate nohighlight">\(x^\star\)</span> is:</p>
<ul class="simple">
<li><p><em>stable</em> (in the sense of Lyapunov) if for any given <span class="math notranslate nohighlight">\(\epsilon&gt;0\)</span>,    there
exists <span class="math notranslate nohighlight">\(\delta(\epsilon)&gt;0\)</span> such that:
\begin{equation}
|x_0-x^\star|\leq \delta \Rightarrow \lim_{t\rightarrow
\infty}|\phi(t,x_0)-x^\star|=0
\end{equation}</p></li>
<li><p><em>attractive</em> if there exists <span class="math notranslate nohighlight">\(\delta&gt;0\)</span> such that:
\begin{equation}
|x_0-x^\star|\leq\delta \Rightarrow \lim_{t\rightarrow
\infty}|\phi(t,x_0)-x^\star|=0
\end{equation}</p></li>
<li><p><em>asymptotically stable</em> (in the sense of Lyapunov) if it is both stable and
attractive.</p></li>
</ul>
<p><em>Theorem [3]:</em> If there exists a continuous function <span class="math notranslate nohighlight">\(V(x)\)</span> defined in a forward
invariant set <span class="math notranslate nohighlight">\(\mathcal{X}\)</span> of the autonomous system (*) such that:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
V(x^\star)=0,\nonumber\\
V(x) &gt; 0,\ \forall x\in\mathcal{X} \text{ such that } x\neq x^\star\nonumber\\
t_1\leq t_2\Rightarrow V(\phi(t_1,x_0)) \geq V(\phi(t_2,x_0))
\end{align}\end{split}\]</div>
<p>then <span class="math notranslate nohighlight">\(x^\star\)</span> is a stable equilibrium point. Moreover if there exists a
continuous function <span class="math notranslate nohighlight">\(Q(x)\)</span> such that:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp;Q(x^\star)=0,&amp;\nonumber\\
&amp;Q(x)&gt;0,\ \forall x\in\mathcal{X} \text{ such that } x\neq x^\star&amp;\nonumber\\
&amp;t_1\leq t_2\Rightarrow V(\phi(t_1,x_0)) \geq V(\phi(t_2,x_0))+\int_{t_1}^{t_2}
Q(\phi(\tau,x_0))d\tau&amp;\nonumber\\
&amp;\|x\|\rightarrow\infty \Rightarrow V(x)\rightarrow\infty&amp;
\end{align}\end{split}\]</div>
<p>then <span class="math notranslate nohighlight">\(x^\star\)</span> is an asymptotically stable equilibrium point.</p>
<div class="section" id="linear-systems">
<h3>Linear Systems<a class="headerlink" href="#linear-systems" title="Permalink to this headline">¶</a></h3>
<p>Consider the linear system:</p>
<p>\begin{equation}
\dot x=Ax, x(0)=x_0
\end{equation}</p>
<p>where <span class="math notranslate nohighlight">\(x\in\mathbb{R}^n\)</span>. The only equilibrium point of this system is
<span class="math notranslate nohighlight">\(x^\star=0\)</span>. Consider the following candidate Lyapunov function:</p>
<p>\begin{equation}
V(x)=x^\text{T}Px
\end{equation}</p>
<p>where <span class="math notranslate nohighlight">\(P\in\mathbb{n\times n}\)</span> is a positive definite matrix and therefore
<span class="math notranslate nohighlight">\(V(x)&gt;0\)</span> for <span class="math notranslate nohighlight">\(x\neq 0\)</span>. The linear system () is stable if there exists a <span class="math notranslate nohighlight">\(P\)</span>:</p>
<p>\begin{equation}
\dot V(x) = (Ax)^\text{T}Px+x^\text{T}PAx &lt; 0
\end{equation}</p>
<p>In case of linear systems, the existence of a Lyapunov function is a necessary
and sufficient condition for stability. The Lyapunov conditions can be written
as the following linear matrix inequalities:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
P&gt;0\nonumber\\
A^\text{T}P+PA&lt;0
\end{align}\end{split}\]</div>
<p><em>Example:</em> Consider a linear system with:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
A=\left[\begin{matrix}0&amp;1\\-1&amp;-2\end{matrix}\right]
\end{equation}\end{split}\]</div>
<p>The eigenvalues of <span class="math notranslate nohighlight">\(A\)</span> are negative:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>A = np.matrix(&#39;0 1; -1 -2&#39;)
np.linalg.eig(A)[0]




array([-1., -1.])
</pre></div>
</div>
<p>Therefore, the system is stable. In the following, we now verify the stability
of the system by solving the following LMIs:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>A = cp.Parameter(2,2)
P = cp.SDPVar(2)

objective = cp.Minimize( 0 )
prob = cp.Problem(objective, [A.T*P+P*A == -cp.SDPVar(2,2), P == cp.SDPVar(2,2)])
A.value = co.matrix(np.matrix(&#39;0 1; -1 -2&#39;))
prob.solve()




0.0
</pre></div>
</div>
<p>where SDPVar(n,n) is an auxiliary positive semi-definite matrix. Since the
stability LMIs are a feasibility problem as opposed to an optimization problem,
we have set the objective function to be a constant value. The optimal solution
of the above LMIs is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>print(P.value)

[ 0.00e+00  0.00e+00]
[ 0.00e+00  0.00e+00]
</pre></div>
</div>
<p>However, this is the trivial answer of these LMIs:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
P\geq 0\nonumber\\
A^\text{T}P+PA\leq 0
\end{align}\end{split}\]</div>
<p>In order to find a feasible answer for strict inequalities using non-strict
inequalities, we can rewrite the inequalities as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
P-\epsilon I\geq 0\nonumber\\
A^\text{T}P+PA+\alpha P\leq 0
\end{align}\end{split}\]</div>
<p>Let us now solve the following LMIs to find a valid Lyapunov function for the
linear system:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>I = np.identity(2)

prob = cp.Problem(objective, [A.T*P+P*A+0.5*P == -cp.SDPVar(2,2), P - 0.1*I == cp.SDPVar(2,2)])
prob.solve()




0.0




print(P.value)

[ 1.13e+00  1.88e+00]
[ 4.93e-02  9.40e-01]
</pre></div>
</div>
<p>It is also possible to add an objective function to the LMIs, for example
<span class="math notranslate nohighlight">\(\lambda_{max}(P)\)</span>, the largest eigenvalue of <span class="math notranslate nohighlight">\(P\)</span>, to have a better conditioned
<span class="math notranslate nohighlight">\(P\)</span> in the solution:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>objective = cp.Minimize( cp.lambda_max(P) )
prob = cp.Problem(objective, [A.T*P+P*A+0.5*P == -cp.SDPVar(2,2), P - 0.1*I == cp.SDPVar(2,2)])
prob.solve()




0.1777777617758615
</pre></div>
</div>
<p>The optimal solution is now equal to:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>print(P.value)

[ 1.39e-01  3.89e-02]
[ 3.89e-02  1.39e-01]
</pre></div>
</div>
<p>We can verify the inequalities by computing the eigenvalues:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>np.linalg.eig(P.value)[0]




array([ 0.17777777,  0.1       ])




np.linalg.eig( (A.T*P+P*A).value )[0]




array([-0.06318906, -0.4923496 ])
</pre></div>
</div>
</div>
<div class="section" id="uncertain-linear-systems">
<h3>Uncertain Linear Systems<a class="headerlink" href="#uncertain-linear-systems" title="Permalink to this headline">¶</a></h3>
<p>Consider the following linear system:</p>
<p>\begin{equation}
\dot x=A(\alpha)x, x(0)=x_0
\end{equation}</p>
<p>where <span class="math notranslate nohighlight">\(A\in\mathbb{R}^{n\times n}\)</span> is an uncertain matrix such that:</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
A(\alpha)=\sum_{i=1}^L \alpha_i A_i
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(A_i\)</span> for <span class="math notranslate nohighlight">\(i=1,\ldots,L\)</span> are known matrices and <span class="math notranslate nohighlight">\(\alpha_i\)</span> for
<span class="math notranslate nohighlight">\(i=1,\ldots,L\)</span> are unknown scalars such that:</p>
<p>\begin{equation}
\sum_{i=1}^L \alpha_i=1
\end{equation}</p>
<p>This system can also be written as a linear differential inclusion:</p>
<p>\begin{equation}
\dot x\in Ax
\end{equation}</p>
<p>where <span class="math notranslate nohighlight">\(A\in\text{conv}(\{A_1,\ldots,A_L\})\)</span>
Using the Lyapunov theorem, it can be shown that the uncertain linear system is
asymptotically stable if there exists a <span class="math notranslate nohighlight">\(P\)</span> such that:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
P &amp;&gt; 0\nonumber\\
A_i^\text{T}P+PA_i &amp;&lt; 0, i=1,\ldots,L
\end{align}\end{split}\]</div>
<p>Note that this condition is stronger than saying all the <span class="math notranslate nohighlight">\(A_i\)</span>’s have to be
stable. In addition to that, it is required that all the <span class="math notranslate nohighlight">\(A_i\)</span>’s share the same
<span class="math notranslate nohighlight">\(P\)</span>.</p>
<p><em>Example:</em> Consider the uncertain linear system () with <span class="math notranslate nohighlight">\(L=2\)</span> and:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\beq A_1=\bmat 1 &amp; -2 \\ 2 &amp; -2\emat,\ A_2=\bmat 1 &amp; 2 \\ -2 &amp; -2\emat\eeq\end{split}\]</div>
<p>The eigenvalues of <span class="math notranslate nohighlight">\(A_1\)</span> and <span class="math notranslate nohighlight">\(A_2\)</span> are on the left side of the complex plane and
even equal:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>A1 = np.matrix(&#39;1 -2; 2 -2&#39;)
np.linalg.eig(A1)[0]




array([-0.5+1.32287566j, -0.5-1.32287566j])




A2 = np.matrix(&#39;1 2; -2 -2&#39;)
np.linalg.eig(A2)[0]




array([-0.5+1.32287566j, -0.5-1.32287566j])
</pre></div>
</div>
<p>However, an uncertain linear system with <span class="math notranslate nohighlight">\(A\)</span> in the convex hull of <span class="math notranslate nohighlight">\(A_1\)</span> and
<span class="math notranslate nohighlight">\(A_2\)</span> is not stable. For example <span class="math notranslate nohighlight">\(A=0.5A_1+0.5A_2\)</span> is not stable:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>np.linalg.eig(0.5*A1+0.5*A2)[0]




array([ 1., -2.])
</pre></div>
</div>
<p>That is a proof for the following LMIs to be infeasible:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>A1 = cp.Parameter(2,2)
A2 = cp.Parameter(2,2)
P = cp.SDPVar(2)
I = np.identity(2)

objective = cp.Minimize( cp.lambda_max(P) )
prob = cp.Problem(objective, [P - 0.1*I == cp.SDPVar(2,2), A1.T*P+P*A1+0.5*P == -cp.SDPVar(2,2), A2.T*P+P*A2+0.5*P == -cp.SDPVar(2,2)])
A1.value = co.matrix(np.matrix(&#39;1 -2; 2 -2&#39;))
A2.value = co.matrix(np.matrix(&#39;1 2; -2 -2&#39;))
prob.solve()




&#39;infeasible&#39;
</pre></div>
</div>
</div>
<div class="section" id="state-feedback-controller">
<h3>State Feedback Controller<a class="headerlink" href="#state-feedback-controller" title="Permalink to this headline">¶</a></h3>
<p>Consider the following linear system:</p>
<p>\begin{equation}
\dot x=Ax+Bu
\end{equation}</p>
<p>where <span class="math notranslate nohighlight">\(x\in\mathbb{R}^n\)</span> and <span class="math notranslate nohighlight">\(u\in\mathbb{R}^m\)</span> denote the state and input
vectors. The objective is to design a state feedback of the form:</p>
<p>\begin{equation}
u = Kx
\end{equation}</p>
<p>to stabilize the closed loop system:</p>
<p>\begin{equation}
\dot x = (A+BK)x
\end{equation}</p>
<p>This system is stable if there exists a <span class="math notranslate nohighlight">\(P\)</span> such that:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
{\color{red}P}&gt;0\nonumber\\
(A+B{\color{red}K})^\text{T}{\color{red}P}+{\color{red}P}(A+B{\color{red}K}) &lt; 0
\end{align}\end{split}\]</div>
<p>The unknown matrices in these inequalities are shown in red. As you see, this is
not a LMI but it is a bilinear matrix inequality (BMI). BMI’s are hard to solve
in general. However, there is a trick for this special BMI to convert it to an
LMI.</p>
<p>We know that the eigenvalues of a matrix and its transpose are the same.
Therefore, the closed loop system () is stable if and only if its dual system is
stable:</p>
<p>\begin{equation}
\dot x = (A+BK)x
\end{equation}</p>
<p>Now, let us write the stability inequalities for the dual system:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
{\color{red}Q}&gt;0\nonumber\\
(A+B{\color{red}K}){\color{red}Q}+{\color{red}Q}(A+B{\color{red}K})^\text{T} &lt; 0
\end{align}\end{split}\]</div>
<p>This is still a BMI. However, if we define <span class="math notranslate nohighlight">\(Y=KQ\)</span>, we can write the inequalities
as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
{\color{red}Q}&gt;0\nonumber\\
A{\color{red}Q}+{\color{red}Q}A^\text{T}+B{\color{red}Y}+{\color{red}Y}^\text{T}
B^\text{T} &lt; 0
\end{align}\end{split}\]</div>
<p>Now, this is a LMI. After solving the LMI, if it is feasible, the controller
gain <span class="math notranslate nohighlight">\(K\)</span> can be computed as:</p>
<p>\begin{equation}
K = YQ^{-1}
\end{equation}</p>
<p>Another way of converting () to a LMI is to multiply both sides of both
inequalities by <span class="math notranslate nohighlight">\(Q=P^{-1}\)</span> and perform the same trick.</p>
<p><em>Example:</em> Consider the following linear system:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\beq \dot x = \bmat 1 &amp; 0.1 \\ 0 &amp; -2 \emat x+\bmat 0 \\ 1 \emat u \eeq\end{split}\]</div>
<p>The objective is to find <span class="math notranslate nohighlight">\(K\)</span> such that with <span class="math notranslate nohighlight">\(u=Kx\)</span> the closed loop system is
stable.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>A = cp.Parameter(2,2)
B = cp.Parameter(2,1)
Q = cp.SDPVar(2)
Y = cp.Variable(1,2)
I = np.identity(2)

objective = cp.Minimize( cp.lambda_max(Q) )
prob = cp.Problem(objective, [Q - 0.1*I == cp.SDPVar(2,2), A*Q+Q*A.T+B*Y+Y.T*B.T+0.5*Q == -cp.SDPVar(2,2)])
A.value = co.matrix(np.matrix(&#39;1 0.1; 0 -2&#39;))
B.value = co.matrix(np.matrix(&#39;0; 1&#39;))
prob.solve()




62.699830858476346
</pre></div>
</div>
<p>The controller gain can now be computed as:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>K = np.dot(Y.value,np.linalg.inv(Q.value))
print(K)

[[-54.46273825  -1.34901911]]
</pre></div>
</div>
<p>The closed loop system is stable:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Acl = (A.value+B.value*K)
np.linalg.eig(Acl)[0]




array([-1.17450955+0.84722018j, -1.17450955-0.84722018j])
</pre></div>
</div>
</div>
</div>
<div class="section" id="dissipativity">
<h2>Dissipativity<a class="headerlink" href="#dissipativity" title="Permalink to this headline">¶</a></h2>
<p>Similar to stability for autonomous systems, there is a concept called
dissipativity for dynamic systems with input. Consider the following dynamical
system:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\dot x=&amp;f(x,w)\nonumber\\
z=&amp;g(x,w)
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(x\in\mathbb{R}^n\)</span> is the state, <span class="math notranslate nohighlight">\(u\in\mathbb{R}^m\)</span> is the input and
<span class="math notranslate nohighlight">\(z\in\mathbb{R}^p\)</span> is the output vector.</p>
<p><em>Definition:</em> The system () is said to be dissipative with storage function <span class="math notranslate nohighlight">\(V\)</span>
and supply rate <span class="math notranslate nohighlight">\(W\)</span>, if:</p>
<p>\begin{equation}
t_1\leq t_2\Rightarrow V(x(t_1))+\int_{t_1}^{t_2}W(z(\tau),w(\tau))d\tau\geq
V(x(t_2))
\end{equation}</p>
<p>If the storage function and the trajectory of the system are smooth, this
inequality can be written as:</p>
<p>\begin{equation}
\nabla_x V(x).\dot x\leq W(z,w)
\end{equation}</p>
<p>Now, consider the following linear system:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\dot x=&amp;Ax+Bw\nonumber\\
z=&amp;Cx+Dw
\end{align}\end{split}\]</div>
<p>with <span class="math notranslate nohighlight">\(x(0)=0\)</span>. It assumed that all the eigenvalues of <span class="math notranslate nohighlight">\(A\)</span> have negative real
values. In the followin, we will review a few special cases of dissipativity.</p>
<div class="section" id="qsr-dissipativity">
<h3>QSR Dissipativity<a class="headerlink" href="#qsr-dissipativity" title="Permalink to this headline">¶</a></h3>
<p>The following statements are equivalent:</p>
<ul>
<li><p>The system is strictly dissipative with the supply rate:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
  s(w,z)=\bmat w \\ z\emat^\text{T}
\bmat Q &amp; S \\ S^\text{T} &amp; R \emat
\bmat w \\ z \emat
  \end{equation}\end{split}\]</div>
</li>
<li><p>For all <span class="math notranslate nohighlight">\(\omega\in\mathbb{R}\cup\{\infty\}\)</span> there holds:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
  \left[\begin{matrix} I \\ T(j\omega)\end{matrix}\right]^\star
\left[\begin{matrix} Q&amp; S \\ S^\text{T}&amp;R\end{matrix}\right]\left[\begin{matrix}
I \\ T(j\omega)\end{matrix}\right] \gt 0
  \end{equation}\end{split}\]</div>
</li>
<li><p>There exists <span class="math notranslate nohighlight">\(P&gt;0\)</span> satisfying the LMI:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
  \left[\begin{matrix} A^\TR P+PA &amp; PB \\ B^\TR P &amp; 0
\end{matrix}\right]-\left[\begin{matrix} 0&amp;I \\ C&amp;D\end{matrix}\right]^\text{T}
\left[\begin{matrix} Q&amp; S \\ S^\text{T}&amp;R\end{matrix}\right]\left[\begin{matrix}
0&amp;I \\ C&amp;D\end{matrix}\right] \lt 0
  \end{equation}\end{split}\]</div>
</li>
</ul>
</div>
<div class="section" id="passivity">
<h3>Passivity<a class="headerlink" href="#passivity" title="Permalink to this headline">¶</a></h3>
<p>The following statements are equivalent:</p>
<ul>
<li><p>System () is strictly dissipative with the supply rate:</p>
<p>\begin{equation}
s(w,z)= w^\text{T} z+z^\text{T} w=2w^\text{T} z
\end{equation}</p>
</li>
<li><p>For all <span class="math notranslate nohighlight">\(\omega\in\mathbb{R}\)</span> with <span class="math notranslate nohighlight">\(\det(j\omega I-A)\neq 0\)</span>, there holds:</p>
<p>\begin{equation}
T(j\omega)^\star+T(j\omega)&gt;0
\end{equation}</p>
</li>
<li><p>There exists <span class="math notranslate nohighlight">\(P&gt;0\)</span> satisfying the LMI:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
  \left[\begin{matrix} A^\text{T} P+PA &amp; PB-C^\text{T} \\ B^\text{T} P-C &amp;
D+D^\text{T} \end{matrix}\right] &lt; 0
  \end{equation}\end{split}\]</div>
</li>
<li><p>If <span class="math notranslate nohighlight">\(D=0\)</span>, there exists <span class="math notranslate nohighlight">\(P&gt;0\)</span> satisfying:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
  A^\text{T}P+PA&lt;0 \nonumber\\
  PB=C^\text{T}
  \end{align}\end{split}\]</div>
</li>
<li><p>System () is RLC realizable, i.e. there exists an RLC network with transfer
function <span class="math notranslate nohighlight">\(T(j\omega)\)</span>.</p></li>
<li><p>For SISO systems:</p>
<p>\begin{equation}
|\angle G(j\omega)| &lt; 90^\circ, \text{Re}(G(j\omega))&gt;0
\end{equation}</p>
</li>
<li><p>Gain margin of system () is infinite.</p></li>
</ul>
<p>One of the properties of passive systems is that the feedback connection of two
passive systems is always stable (the loop phase is less than 180 degrees).</p>
</div>
<div class="section" id="mathcal-h-infty-gain-bounded-l-2-rightarrow-bounded-l-2">
<h3><span class="math notranslate nohighlight">\(\mathcal{H}_\infty\)</span> Gain (Bounded <span class="math notranslate nohighlight">\(L_2\rightarrow\)</span> Bounded <span class="math notranslate nohighlight">\(L_2\)</span>)<a class="headerlink" href="#mathcal-h-infty-gain-bounded-l-2-rightarrow-bounded-l-2" title="Permalink to this headline">¶</a></h3>
<p>The following statements are equivalent:</p>
<ul>
<li><p>The system is strictly dissipative with the supply rate:</p>
<p>\begin{equation}
s(w,z)=\gamma^2 w^\text{T} w-z^\text{T} z
\end{equation}</p>
</li>
<li><p>For all <span class="math notranslate nohighlight">\(\omega\in\mathbb{R}\)</span>:</p>
<p>\begin{equation}
|T(j\omega)|<em>\infty=\sup</em>{0&lt;|w|_2&lt;\infty}\frac{|z|_2}{|w|_2} \lt
\gamma
\end{equation}</p>
</li>
<li><p>There exists <span class="math notranslate nohighlight">\(P&gt;0\)</span> satisfying the LMI:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
  \left[\begin{matrix} A^\text{T} P+PA+C^\text{T} C &amp; PB+C^\text{T}
D\\ B^\text{T} P+D^\text{T} C &amp; D^\text{T} D-\gamma^2 I \end{matrix}\right]&lt; 0
  \end{equation}\end{split}\]</div>
</li>
<li><p>There exists <span class="math notranslate nohighlight">\(P&gt;0\)</span> satisfying the LMI:</p>
<p>\begin{equation}
\left[\begin{matrix} A^\text{T} P+PA &amp; PB &amp; C^\text{T}\B^\text{T} P  &amp;
-\gamma^2 I &amp; D^\text{T}\C&amp;D&amp;-I \end{matrix}\right]&lt; 0
\end{equation}</p>
</li>
</ul>
</div>
<div class="section" id="mathcal-h-infty-state-feedback-controller">
<h3><span class="math notranslate nohighlight">\(\mathcal{H}_\infty\)</span> State Feedback Controller<a class="headerlink" href="#mathcal-h-infty-state-feedback-controller" title="Permalink to this headline">¶</a></h3>
<p>Consider the following linear system:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\dot x=&amp;Ax+B_ww+B_uu\nonumber\\
z =&amp;C_zx+D_ww+D_uu
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(u\)</span> is the control input. We would like to design a controller of the form
<span class="math notranslate nohighlight">\(u=Kx\)</span> such that for the closed loop system:</p>
<p>\begin{equation}
\sup_{|w|_2\neq 0}\frac{|z|_2}{|w|_2}&lt;\gamma
\end{equation}</p>
<p>The design problem can be formulated as the following matrix inequality:</p>
<p>\begin{equation}
Q&gt;0
\end{equation}</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
\left[\begin{matrix} AQ+Qa^\text{T}+B_uY+Y^\text{T}B_u^\text{T}+B_wB_w^\text{T}
&amp;
(C_zQ+D_{zu}Y+D_wB_w^\text{T})^\text{T} \\ C_zQ+D_uY+D_wB_w^\text{T} &amp; D_w
D_w^\text{T}-\gamma^2 I \end{matrix}\right]&lt; 0
\end{equation}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(K=YQ^{-1}\)</span></p>
<p><strong>Proof:</strong> It can easily be shown that the <span class="math notranslate nohighlight">\(\mathcal{H}_\infty\)</span> norm of  the
system is less than <span class="math notranslate nohighlight">\(\gamma\)</span> if it is dissipative with the following supply
rate:</p>
<p>\begin{equation}
s(w,z)=w^\text{T} w-\frac{1}{\gamma^2}z^\text{T} z
\end{equation}</p>
<p>Using this supply rate, the LMI’s can be written as:</p>
<p>\begin{equation}
P&gt;0
\end{equation}</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
\left[\begin{matrix} A^\text{T} P+PA &amp; PB &amp; C^\text{T} \\ B^\text{T} P  &amp; - I &amp;
D^\text{T} \\ C&amp;D&amp;-\gamma^2I \end{matrix}\right]&lt; 0
\end{equation}\end{split}\]</div>
<p>Now, if we write the same LMI for the closed loop system, we have:</p>
<p>\begin{equation}
P&gt;0
\end{equation}</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
\left[\begin{matrix} (A+B_u{\color{red} K})^\text{T} {\color{red}
P}+{\color{red} P}(A+B_u{\color{red} K}) &amp; {\color{red} P}B_w &amp;
(C+D_u{\color{red} K})^\text{T} \\ B_w^\text{T} {\color{red} P}  &amp; - I &amp;
D_w^\text{T} \\ C+D_u{\color{red} K}&amp;D_w&amp;-\gamma^2I \end{matrix}\right]&lt; 0
\end{equation}\end{split}\]</div>
<p>Again, this is a BMI. To formulate the problem as a LMI, let multiply both sides
of the inequality by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
\left[\begin{matrix}Q &amp; 0&amp; 0 \\ 0&amp;I&amp;0 \\ 0&amp;0&amp; I\end{matrix}\right]
\end{equation}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(Q=P^{-1}\)</span>. The result is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
\left[\begin{matrix} {\color{red} Q}(A+B_u{\color{red} K})^\text{T}
+(A+B_u{\color{red} K}){\color{red} Q} &amp; B_w &amp; {\color{red} Q}(C+D_u{\color{red}
K})^\text{T} \\ B_w^\text{T}  &amp; - I &amp; D_w^\text{T} \\ (C+D_u{\color{red}
K}){\color{red} Q}&amp;D_w&amp;-\gamma^2I \end{matrix}\right]&lt; 0
\end{equation}\end{split}\]</div>
<p>Now, if we define <span class="math notranslate nohighlight">\(Y=KQ\)</span>, we have the following LMI:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
\left[\begin{matrix} {\color{red} Q}A^\text{T} +A{\color{red}
Q}+Y^\text{T}B_u^\text{T}+B_u{\color{red} Y} &amp; B_w &amp; {\color{red}
Q}C^\text{T}+{\color{red} Y}^\text{T}D_u^\text{T} \\ B_w^\text{T}  &amp; - I &amp;
D_w^\text{T} \\ C{\color{red} Q}+D_u{\color{red} Y}&amp;D_w&amp;-\gamma^2I
\end{matrix}\right]&lt; 0
\end{equation}\end{split}\]</div>
<p>This LMI can be rearranged as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
\left[\begin{matrix} A{\color{red} Q}+{\color{red} Q}A^\text{T} +B_u{\color{red}
Y}+Y^\text{T}B_u^\text{T} &amp; {\color{red} Q}C^\text{T}+{\color{red}
Y}^\text{T}D_u^\text{T} &amp; B_w \\ C{\color{red} Q}+D_u{\color{red}
Y}&amp;-\gamma^2I&amp;D_w \\ B_w^\text{T} &amp; D_w^\text{T} &amp; - I \end{matrix}\right]&lt; 0
\end{equation}\end{split}\]</div>
<p>Using the Schur complement, we can now write the LMI as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
\left[\begin{matrix} A{\color{red} Q}+{\color{red} Q}A^\text{T} +B_u{\color{red}
Y}+{\color{red} Y}^\text{T}B_u^\text{T}+B_wB_w^\text{T} &amp; {\color{red}
Q}C^\text{T}+{\color{red} Y}^\text{T}D_u^\text{T}+B_wD_w^\text{T} 
\\ C{\color{red} Q}+D_u{\color{red} Y}+D_wB_w^\text{T}&amp;-\gamma^2I+D_wD_w^\text{T}
\end{matrix}\right]&lt; 0
\end{equation}\end{split}\]</div>
<p>This LMI is the same as we were looking for and it ends the proof.</p>
</div>
<div class="section" id="generalized-mathcal-h-2-gain-bounded-l-2-rightarrow-bounded-l-infty">
<h3>Generalized <span class="math notranslate nohighlight">\(\mathcal{H}_2\)</span> Gain (Bounded <span class="math notranslate nohighlight">\(L_2\rightarrow\)</span> Bounded <span class="math notranslate nohighlight">\(L_\infty\)</span>)<a class="headerlink" href="#generalized-mathcal-h-2-gain-bounded-l-2-rightarrow-bounded-l-infty" title="Permalink to this headline">¶</a></h3>
<p>If <span class="math notranslate nohighlight">\(D=0\)</span> then the following statements are equivalent:</p>
<ul>
<li><p>System () is strictly dissipative with the supply rate:</p>
<p>\begin{equation}
s(w,z)=w^\text{T}w
\end{equation}</p>
</li>
<li><p>For all <span class="math notranslate nohighlight">\(\omega\in\mathbb{R}\)</span>:</p>
<p>\begin{equation}
|T(j\omega)|<em>{2,\infty}=\sup</em>{0 &lt; |w|<em>2 &lt;
\infty}\frac{|z|</em>\infty}{|w|_2} &lt; \gamma
\end{equation}</p>
</li>
<li><p>There exists <span class="math notranslate nohighlight">\(P\)</span> satisfying the LMIs:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
  \left[\begin{matrix} A^\text{T} P+PA&amp;PB \\ B^\text{T} P&amp; -I\end{matrix}\right]
\lt 0\nonumber\\
  \left[\begin{matrix} P&amp;C^\text{T} \\ C&amp;\gamma^2 I\end{matrix}\right] \gt 0
  \end{align}\end{split}\]</div>
</li>
</ul>
</div>
<div class="section" id="generalized-mathcal-h-2-state-feedback-controller">
<h3>Generalized <span class="math notranslate nohighlight">\(\mathcal{H}_2\)</span> State Feedback Controller<a class="headerlink" href="#generalized-mathcal-h-2-state-feedback-controller" title="Permalink to this headline">¶</a></h3>
<p>Consider the following linear system:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\dot x=&amp;Ax+B_ww+B_uu\nonumber\\
z =&amp;C_zx+D_uu
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(u\)</span> is the control input. We would like to design a controller of the form
<span class="math notranslate nohighlight">\(u=Kx\)</span> such that for the closed loop system:</p>
<p>\begin{equation}
\sup_{|w|<em>2\neq 0}\frac{|z|</em>\infty}{|w|_2}&lt;\gamma
\end{equation}</p>
<p>The design problem can be formulated as the following matrix inequality:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
  \left[\begin{matrix}
AQ+QA^\text{T}+B_uY+Y^\text{T}B_u^\text{T}&amp;B_w \\ B_w^\text{T}&amp;
-I\end{matrix}\right] \lt 0\nonumber\\
  \left[\begin{matrix} Q&amp;QC^\text{T}+Y^\text{T}D_u^\text{T} \\ CQ+D_uY&amp;\gamma^2
I\end{matrix}\right] \gt 0
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(K=YQ^{-1}\)</span></p>
</div>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="SemidefiniteProgram.html" title="previous page">Semidefinite program</a>
    <a class='right-next' id="next-link" href="References.html" title="next page">References</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Behzad Samadi<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>